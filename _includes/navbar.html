{% assign cats = site.recipes
  | where:"layout","recipe"
  | map:"category" | compact | uniq | sort %}

<nav class="topnav">
  <div class="topnav-left">
    <a href="{{ '/' | relative_url }}">Home</a>

    <div class="dropdown">
      <button class="dropbtn">Rezepte</button>
      <div class="dropdown-content">
        {% for c in cats %}
          {% assign cat_landing = site.recipes
            | where:"layout","category"
            | where:"category", c
            | first %}

          <div class="dropdown-category">
            {% if cat_landing %}
              <strong><a href="{{ cat_landing.url | relative_url }}">{{ c }}</a></strong>
            {% else %}
              <strong>{{ c }}</strong>
            {% endif %}

            <ul>
              {% assign subs = site.recipes
                | where:"layout","recipe"
                | where:"category", c
                | map:"subcategory" | compact | uniq | sort %}

              {% for s in subs %}
                {% assign landing = site.recipes
                  | where:"layout","category"
                  | where:"category", c
                  | where:"subcategory", s
                  | first %}

                <li>
                  {% if landing %}
                    <a href="{{ landing.url | relative_url }}">{{ s }}</a>
                  {% else %}
                    <a href="{{ '/recipes/' | append:(s | slugify) | append:'/' | relative_url }}">{{ s }}</a>
                  {% endif %}
                </li>
              {% endfor %}
            </ul>
          </div>
        {% endfor %}
      </div>
    </div>
  </div>

  <div class="topnav-right">
    <a href="{{ '/about' | relative_url }}">Ãœber mich</a>
  </div>
</nav>
